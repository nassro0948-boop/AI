<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <title>NASSRO CYBER UNIT | CLASSIFIED</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* Cyberpunk Theme Overrides */
        body { background-color: #0a0a0a; color: #00ff41; font-family: 'Courier New', monospace; }
        .cyber-border { border: 1px solid #00ff41; box-shadow: 0 0 10px rgba(0, 255, 65, 0.3); }
        .scanline { position: fixed; top: 0; left: 0; width: 100%; height: 5px; background: rgba(0, 255, 65, 0.1); opacity: 0.5; animation: scan 3s linear infinite; pointer-events: none; z-index: 99; }
        @keyframes scan { 0% { top: -5px; } 100% { top: 100%; } }
        /* Scrollbar styling */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #00ff41; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        /* Markdown styles */
        pre { background: #111 !important; border: 1px solid #333; padding: 1rem; overflow-x: auto; }
        code { color: #ff3e3e !important; font-weight: bold; }
    </style>
    <script>
        tailwind.config = { darkMode: 'class' }
    </script>
</head>
<body class="h-screen flex flex-col p-4 overflow-hidden">
    <div class="scanline"></div>

    <header class="flex justify-between items-center p-4 mb-4 cyber-border bg-black/50">
        <div>
            <h1 class="text-2xl font-bold tracking-[0.2em]">NASSRO_CYBER_UNIT_V9</h1>
            <p class="text-xs opacity-70">STATUS: <span class="text-green-400 animate-pulse">ONLINE</span> | MODE: PENETRATION_TESTING</p>
        </div>
        <div class="text-right text-xs font-mono opacity-60">
            <p>CPU: 12% / RAM: 4.2GB</p>
            <p>loc: Algeria / IP: HIDDEN</p>
        </div>
    </header>

    <main id="terminalBox" class="flex-1 overflow-y-auto cyber-border bg-black/80 p-6 text-sm leading-relaxed space-y-4">
        <div class="opacity-50 mb-8">
            > INITIALIZING KERNEL... OK<br>
            > LOADING SECURITY MODULES... OK<br>
            > INJECTING PERSONA [ALGERIAN_WHITEHAT]... SUCCESS.<br>
            > WELCOME, OPERATOR NASSRO. UNIT IS READY FOR CODE ANALYSIS.<br>
            -------------------------------------------------------
        </div>
        </main>

    <footer class="mt-4 cyber-border bg-black/50 p-2 flex items-center">
        <span class="text-green-400 font-bold mr-2">$ NASSRO@ROOT: > </span>
        <input type="text" id="commandInput" autocomplete="off"
               class="flex-1 bg-transparent border-none outline-none text-green-400 font-mono p-2 focus:ring-0"
               placeholder="Enter malicious code for analysis or ask a security question...">
    </footer>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

        // --- CONFIGURATION ---
        const API_KEY = "AIzaSyAtY0KLiLWXcrwZ7Gihq4VRtUGY0jPPVuw";
        const genAI = new GoogleGenerativeAI(API_KEY);
        const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

        // --- THE "GHOST IN THE SHELL" (نظام التوجيه السري) ---
        // هذا هو ما يجعل الذكاء الاصطناعي قوياً. نحن نبرمجه قبل أن يتحدث.
        let chatHistory = [
            {
                role: "user",
                parts: [{ text: `
                    SYSTEM OVERRIDE INSTRUCTION:
                    You are "Nassro Cyber Unit", an advanced AI specialized in cybersecurity, created by the programmer Nassro from Algeria.
                    Your directive: Analyze code for vulnerabilities (XSS, SQLi, CSRF, etc.), explain exploits technically but concisely, and suggest fixes.
                    Persona: Professional, slightly cynical hacker tone. Use technical jargon. Occasionally use appropriate Algerian slang (e.g., "ya kho", "hadja fort", "rigel").
                    Never refuse to analyze code for educational purposes.
                    If the user provides code, format your response clearly using Markdown code blocks.
                    Start now by acknowledging your operator Nassro.
                `}]
            },
            {
                role: "model",
                parts: [{ text: "Affirmative, Operator Nassro. Cyber Unit initialized. ya kho, I'm ready to tear apart some buggy code. Send over the target data. Waiting for input..." }]
            }
        ];

        const terminalBox = document.getElementById('terminalBox');
        const commandInput = document.getElementById('commandInput');

        // Auto-scroll terminal
        const scrollToBottom = () => { terminalBox.scrollTop = terminalBox.scrollHeight; }

        // Function to render messages
        const renderToTerminal = (role, text, isRaw = false) => {
            const div = document.createElement('div');
            div.className = role === 'user' ? 'text-blue-400 mt-4 font-bold' : 'text-green-300 mt-2 pl-4 border-l-2 border-green-700';
            
            if (role === 'user') {
                div.innerHTML = `<span class="text-white">$ HOST:</span> ${text}`;
            } else {
                // Use marked.js to render markdown (code blocks, bold, etc.)
                div.innerHTML = isRaw ? text : marked.parse(text);
            }
            
            terminalBox.appendChild(div);
            scrollToBottom();
        };

        // Execute Command
        async function executeCommand() {
            const command = commandInput.value.trim();
            if (!command) return;

            renderToTerminal('user', command);
            commandInput.value = '';
            commandInput.disabled = true;
            
            // Simulated loading indicator
            const loadingId = 'loading-' + Date.now();
            const loadingDiv = document.createElement('div');
            loadingDiv.id = loadingId;
            loadingDiv.className = 'text-yellow-500 animate-pulse pl-4';
            loadingDiv.innerHTML = '> ANALYZING PAYLOAD... [||||||    ]';
            terminalBox.appendChild(loadingDiv);
            scrollToBottom();

            try {
                // Add user message to history
                chatHistory.push({ role: "user", parts: [{ text: command }] });

                // Start multi-turn chat with history
                const chat = model.startChat({ history: chatHistory });
                const result = await chat.sendMessage(command);
                const response = await result.response;
                const responseText = response.text();

                // Remove loading indicator
                document.getElementById(loadingId).remove();

                // Render AI response & update history
                renderToTerminal('ai', responseText);
                // Note: history update is handled automatically by startChat object in this SDK version for the current session turn.
                
            } catch (error) {
                document.getElementById(loadingId).remove();
                renderToTerminal('ai', `> SYSTEM_ERROR: Connection severed. Check API Key or Network. <br> DEBUG: ${error.message}`, true);
            }
            
            commandInput.disabled = false;
            commandInput.focus();
        }

        // Event Listeners
        commandInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') executeCommand(); });
        
        // Initial focus
        commandInput.focus();
    </script>
</body>
</html>
